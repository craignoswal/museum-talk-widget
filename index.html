<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>Talk</title>

    <style>
      html, body {
        margin: 0;
        height: 100%;
        background: #fff;
      }

      #error {
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
        padding: 16px;
      }

      /* Visible (non-spoken) disclosure */
      #disclaimer {
        position: fixed;
        top: 10px;
        left: 10px;
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
        font-size: 12px;
        background: rgba(255, 255, 255, 0.85);
        padding: 6px 8px;
        border-radius: 8px;
        z-index: 9999;
      }
    </style>
  </head>

  <body>
    <div id="disclaimer">AI-generated dramatization.</div>

    <!-- Default widget behavior (floating) -->
    <elevenlabs-convai id="el-widget"></elevenlabs-convai>

    <script>
      const params = new URLSearchParams(window.location.search);

      // REQUIRED
      const agentId = params.get("agent_id");

      // OPTIONAL context for the agent to use (if your agent prompt references them)
      const title = params.get("title");
      const artist = params.get("artist");

      const widget = document.getElementById("el-widget");

      if (!agentId) {
        document.body.innerHTML =
          "<div id='error'><h2>Missing agent_id</h2><p>Add <code>?agent_id=...</code> to the URL.</p></div>";
      } else {
        widget.setAttribute("agent-id", agentId);

        // Pass optional context as dynamic variables
        const dyn = {};
        if (title) dyn.title = title;
        if (artist) dyn.artist = artist;

        widget.setAttribute("dynamic-variables", JSON.stringify(dyn));

        // Allow links in markdown responses
        widget.setAttribute("markdown-link-allowed-hosts", "*");
      }
    </script>

    <script
      src="https://unpkg.com/@elevenlabs/convai-widget-embed"
      async
      type="text/javascript"
    ></script>
  </body>
</html>
